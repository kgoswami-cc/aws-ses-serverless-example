trigger:
  - master
pool:
  vmImage: ubuntu-latest
stages:
  - stage: StageASPMGateCheck
    displayName: Stage ASPM Gate Check
    jobs:
      - job: BuildJob
        displayName: Build Job
        steps:
          - script: >-
              exit 0
            displayName: ASPM Gate Check
  - stage: BuildKG
    displayName: Build Stage
    jobs:
      - job: BuildJob
        displayName: Build Job
        steps:
          - script: >-
              exit 1
            displayName: ASPM Gate Check
          - script: 'echo "Organization URL: $(System.TeamFoundationCollectionUri)"'
            displayName: Print Organization URL
          - script: 'echo "Project Name: $(System.TeamProject)"'
            displayName: Print Project Name
          - checkout: self
          - script: >
              echo "Repo URL:
              https://github.com/kgoswami-cc/aws-ses-serverless-example" 

              #exit 1
  - stage: TestKG
    displayName: Test Stage
    dependsOn: BuildKG
    jobs:
      - job: TestJob
        displayName: Test Job
        steps:
          - script: 'echo "Organization URL: $(System.TeamFoundationCollectionUri)"'
            displayName: Print Organization URL
          - script: 'echo "Project Name: $(System.TeamProject)"'
            displayName: Print Project Name
          - checkout: self
          - script: >-
              echo "Repo URL:
              https://github.com/kgoswami-cc/aws-ses-serverless-example"
            displayName: Print Repo URL
          - script: npm install
            displayName: Install Dependencies
          - script: npm test
            displayName: Run Tests
